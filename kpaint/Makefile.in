# $Id$
##
## Makefile for kpaint
##

#
# Configuration
#
prefix 	= 	@prefix@
INCDIRS	=	@all_includes@ -I.. -I../kview
LIBDIR	=	@all_libraries@ -Ltools
MOC	=	@MOC@
INSTALL	=   	@INSTALL@ -m 644
CXX	= 	@CXX@
DEFS	=	-DKPDEBUG -DAPPHELPCONTENTSURL="\"$(prefix)/doc/HTML/kpaint/kpaint.html\"" -DHAVE_CONFIG_H
LDLIBS	=	-lkdecore -lkdeui -lkptools -lgif -lqt -lXext -lm -lX11 -ljpeg
METADIR	=	metas

INSTALL_DIR = @INSTALL@ -d -m 755 
# Uncomment this is you are using Qt 1.2 beta 3 or higher
#DEFS+=	-DNEWQT

#
# End Configuration
#

CXXFLAGS=	@CXXFLAGS@ $(DEFS) $(INCDIRS)
LDFLAGS=	@LDFLAGS@ $(LIBDIR)

OBJ=	main.o \
	app.o \
	canvas.o \
	kpaint.o \
	manager.o \
	canvassize.o \
	properties.o \
	QwViewport.o \
	KTopWidget.o \
	KToolbar.o \
	KStatusbar.o \
	gif.o jpeg.o

METAS=	canvas.moc \
	kpaint.moc \
	manager.moc \
	properties.moc \
	QwViewport.moc \
	KTopWidget.moc \
	KToolbar.moc \
	KStatusbar.moc

OBJS= $(addprefix objs/,$(OBJ))

.PHONY:	all clean tools install uninstall

#
# Implicit rules
#

objs/%.o:	%.cpp
	$(CXX) -c $(CXXFLAGS) -o $@ $<

%.moc:	%.h
	$(MOC) -o $(METADIR)/$@ $<

all:	kpaint

install:
	$(INSTALL_DIR) $(prefix)/bin
	$(INSTALL_DIR) $(prefix)/doc/HTML/kpaint
	$(INSTALL) kpaint $(prefix)/bin
	$(INSTALL) doc/HTML/kpaint.html $(prefix)/doc/HTML/kpaint
	$(INSTALL_DIR) $(prefix)/apps/Applications
	$(INSTALL) kpaint.kdelnk $(prefix)/apps/Applications 

uninstall:
	rm -f $(prefix)/bin/kpaint
	rm -rf $(prefix)/doc/HTML/kpaint

tools:
	$(MAKE) -C tools all

kpaint:	tools $(METAS) $(OBJS)
	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LDLIBS)

clean:
	$(MAKE) -C tools clean
	-rm -f $(OBJS) $(METADIR)/*.moc kpaint tools/libkptools.a

realclean:  clean
	$(MAKE) -C tools realclean
	-rm -f kpaint



