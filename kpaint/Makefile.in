# $Id$
##
## Makefile for kpaint
##

#
# Configuration
#
prefix 	= 	@prefix@
INCDIRS	=	@all_includes@ -I.. -I../kview
LIBDIR	=	@all_libraries@ -Ltools
MOC	=	@MOC@
CXX	= 	@CXX@
DEFS	=	-DHAVE_CONFIG_H
LDLIBS	=	-lkfm -lkdecore -lkdeui -lkptools -lgif @LIBJPEG@ -lqt -lXext @LIBSOCKET@ -lm
METADIR	=	metas

INSTALL_DIR = @INSTALL@ -d -m 755 
INSTALL_DATA= @INSTALL@ -m 644
INSTALL_BIN = @INSTALL@ -m 755

#
# End Configuration
#

CXXFLAGS=	@CXXFLAGS@ $(DEFS) $(INCDIRS)
LDFLAGS=	@LDFLAGS@ $(LIBDIR)

OBJS=	main.o \
	app.o \
	canvas.o \
	kpaint.o \
	manager.o \
	formats.o \
	infodialog.o \
	palette.o \
	palettedialog.o \
	formatdialog.o \
	canvassize.o \
	properties.o \
	gif.o \
	jpeg.o \
	QwViewport.o

METAS=	canvas.moc \
	app.moc \
	kpaint.moc \
	manager.moc \
	infodialog.moc \
	properties.moc \
	formatdialog.moc \
	palette.moc \
	palettedialog.moc \
	QwViewport.moc

.PHONY:	all clean kplib install uninstall

#
# Implicit rules
#

%.o:	%.cpp
	$(CXX) -c $(CXXFLAGS) -o $@ $<

%.moc:	%.h
	$(MOC) -o $@ $<

all:	kplib kpaint

install: all
	$(INSTALL_DIR) $(prefix)/bin
	$(INSTALL_BIN) kpaint $(prefix)/bin
	$(INSTALL_DIR) $(prefix)/lib/pics/toolbar
	(cd doc ; $(MAKE) install)
	(cd toolpics ; $(MAKE) install)
	$(INSTALL_DIR) $(prefix)/apps/Applications
	$(INSTALL_DATA) Paint.kdelnk $(prefix)/apps/Applications 

uninstall:
	-rm -f $(prefix)/bin/kpaint
	-rm -rf $(prefix)/doc/HTML/kpaint
	-rm -f $(prefix)/apps/Applications/Paint.kdelnk

kplib:
	(cd tools; $(MAKE) all)

kpaint: $(METAS) $(OBJS)
	$(CXX) $(LDFLAGS) -o $@ $(OBJS) $(LDLIBS)

clean:
	$(MAKE) -C tools clean
	-rm -f $(OBJS) *.moc kpaint tools/libkptools.a

realclean:  clean
	$(MAKE) -C tools realclean
	-rm -f kpaint



