#
# Makefile for kghostview
#

.SUFFIXES: .cpp

CXX	= @CXX@
CC	= @CC@
MOC	= @MOC@
INCFL	= @all_includes@ -I. -I.. 
CXXFLAGS = @CXXFLAGS@ $(INCFL) -DHAVE_CONFIG_H
CFLAGS = @CFLAGS@ $(INCFL) -DHAVE_CONFIG_H
LDFLAGS = @LDFLAGS@ @all_libraries@ -L. -lkfm -lkdecore -lkdeui -lqt -lX11 -lXext -lm

############# Install ##############

INSTALL = @INSTALL@ -m 0755
INSTALL_DATA = @INSTALL@ -m 0644
INSTALL_DIR = @INSTALL@ -d -m 0755

prefix = @prefix@
BINDIR = $(prefix)/bin
LIBDIR = $(prefix)/lib
SHAREDIR=$(prefix)/share
ICONDIR = $(SHAREDIR)/icons
DOCSDIR = $(SHAREDIR)/doc/default/HTML/kghostview
KDELNKDIR = $(SHAREDIR)/Graphics/applnk


########## Implicit Rules ##########

.SUFFIXES: .cpp .c

.cpp.o:
	$(CXX) $(CXXFLAGS) $(DEFS) -c $<

.c.o:
	$(CC) -c $(CFLAGS) $(DEFS) $<

########## Files ##########

SRCS = marklist.cpp copyright.cpp interpreter.cpp messages.cpp info.cpp print.cpp goto.cpp viewcontrol.cpp main.cpp kghostview.cpp kpswidget.cpp ps.c
SRCMETA = marklist.moc copyright.moc interpreter.moc messages.moc info.moc print.moc goto.moc viewcontrol.moc kghostview.moc kpswidget.moc
HDRS = marklist.h copyright.h interpreter.h messages.h info.h print.h goto.h viewcontrol.h kghostview.h kpswidget.h ps.h
OBJS = marklist.o copyright.o interpreter.o messages.o info.o print.o goto.o viewcontrol.o main.o kghostview.o kpswidget.o ps.o

TARGET = kghostview

########## Build Rules ##########

all: $(TARGET)

Makefile: Makefile.in
	cd .. && CONFIG_FILES=kghostview/$@ CONFIG_HEADERS= $(SHELL) ./config.status

$(TARGET): $(SRCMETA) $(OBJS)
	$(CXX) -o $(TARGET) $(OBJS) $(LDFLAGS)

install: all
	[ -d $(BINDIR) ] || $(INSTALL_DIR) $(BINDIR)
	$(INSTALL) $(TARGET) $(BINDIR)
	[ -d $(DOCSDIR) ] || $(INSTALL_DIR) $(DOCSDIR)
	(cd doc && $(MAKE) install)
	$(INSTALL_DIR) $(KDELNKDIR)
	$(INSTALL_DATA) kghostview.kdelnk $(KDELNKDIR)


uninstall:
	rm -f $(BINDIR)/$(TARGET)
	(cd doc && $(MAKE) uninstall)
	rm -f $(KDELNKDIR)/kghostview.kdelnk

clean:
	rm -f core *~ *.bak *.BAK $(SRCMETA) $(OBJS) $(TARGET)

veryclean:
	rm -f *~ *.bak *.BAK $(TARGET) $(SRCMETA) $(OBJS) core

depend: $(SRCS)
	@makedepend $(INCFLAGS) $(SRCS) 2> /dev/null

messages:
	@XGETTEXT@ -C --keyword=i18n -x ../../kdelibs/po/kde.po *.cpp
	
########## Meta objects ##########

%.moc: %.h
	$(MOC) $< -o $@

##################################
# DO NOT DELETE

